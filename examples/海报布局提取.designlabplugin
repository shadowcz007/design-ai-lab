{
  "id": "8b22d5976c5ed5084878431968624f0a84a91ab9",
  "poster": "data:image/png;base64,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",
  "title": "海报布局提取",
  "knowledge": {
    "course": "-  支持svg导出结果\n- u2net\n- opencv 阈值分割\n\nlet src = cv.imread('canvasInput');\nlet dst = new cv.Mat();\ncv.cvtColor(src, src, cv.COLOR_RGBA2GRAY, 0);\n\ncv.adaptiveThreshold(src, dst, 200, cv.ADAPTIVE_THRESH_GAUSSIAN_C, cv.THRESH_BINARY, 3, 2);\ncv.imshow('canvasOutput', dst);\nsrc.delete();\ndst.delete();\n\n\n",
    "readme": "海报布局提取",
    "author": "shadow",
    "version": "0.2"
  },
  "code": "//Hello AI world!\nvar layout = new Lab.Canvas(300, 300, false, true)\n// 双击移动到最顶部\nlayout.dblclick = opt => {\n  layout.moveToTop(opt.target)\n}\n\nvar yolo, u2net\n\nvar isRun = false\n\nfunction gui () {\n  let ip = Lab.ui.createInput('img', 'text', doImage)\n\n  let plus = Lab.ui.createIcon('plus', () => {\n    let im = Lab.base.clipboard.read('img')\n    if (im) doImage([im.toDataURL()])\n  })\n\n  Lab.ui.add(layout.getElement())\n  yolo = Lab.ai.yolo\n  u2net = Lab.ai.u2net\n\n  Lab.ui.add(ip)\n  Lab.ui.add(plus)\n}\n\nasync function doImage (urls) {\n  if (isRun) return\n  layout.reset()\n  isRun = true\n  // console.log(urls)\n  let im = await Lab.ui.createImage(urls[0])\n  // window._im=im;\n  layout.addImg(\n    im,\n    {\n      lockMovementX: true,\n      lockRotation: true,\n      lockScalingX: true,\n      lockScalingY: true\n    },\n    false,\n    false\n  )\n  await doResearch(im)\n  layout.zoomToFitCanvas()\n  isRun = false\n\n  //\n  await extractSegment(im)\n}\n\n// 分割图像，待处理成svg的框框\nasync function extractSegment (im) {\n  let res = await Lab.ai.deeplab.segmentation(im)\n\n  let imgdata = new ImageData(res.segmentationMap, res.width, res.height)\n  //    res.legend\n  let canvas = Lab.ui.createCanvas(res.width, res.height, '', '', true)\n  let ctx = canvas.getContext('2d')\n  ctx.putImageData(imgdata, 0, 0)\n  Lab.ui.add(canvas)\n  console.log(res.legend)\n}\n\nasync function doResearch (img) {\n  // 文本检测\n  let texts = await Lab.Text.getText(img)\n  // console.log('texts',JSON.stringify(texts,null,2))\n  texts.forEach(t => {\n    t = Object.assign(t, {\n      fill: 'rgba(255,0,0,0.4)',\n      stroke: 'red',\n      left: t.x,\n      top: t.y\n    })\n    addRect(t)\n  })\n\n  // 多目标检测\n  let boxes = await yolo.detect(img)\n  console.log(boxes)\n  boxes.forEach(t => {\n    t = Object.assign(t, {\n      fill: 'rgba(0,255,0,0.4)',\n      stroke: 'rgba(0,255,0,1)'\n    })\n    addRect(t)\n  })\n\n  // 人体姿态识别\n  let posenetRes = await Lab.ai.posenet.estimateMultiplePoses(img)\n  console.log(posenetRes)\n\n  // 显著度+分割\n  let seg = await u2net.segment(img)\n\n  // test\n  // let atCanvas = adaptiveThreshold(seg);\n  // layout.addImg(atCanvas)\n  console.log(Lab.shape.findContoursForImgsBatch([seg]))\n\n  // console.log(seg)\n  // 外围父级轮廓\n  let rect = Lab.shape.getBoundingRect(seg)\n  if (rect) {\n    // console.log(rects)\n    var t = Object.assign(rect, {\n      fill: 'rgba(0,0,255,0.4)',\n      stroke: 'rgba(0,0,255,1)',\n      left: rect.x,\n      top: rect.y\n    })\n    addRect(t)\n  }\n\n  layoutClassify(rect, seg.width, seg.height)\n}\n\nfunction layoutClassify (rect, w, h) {\n  console.log(rect, w, h)\n  let c = document.createElement('canvas')\n  c.width = w\n  c.height = h\n\n  let ctx = c.getContext('2d')\n  ctx.fillStyle = 'black'\n  ctx.fillRect(rect.x, rect.y, rect.width, rect.height)\n\n  let nc = document.createElement('canvas')\n  nc.width = 9\n  nc.height = 9\n  var nctx = nc.getContext('2d')\n  nctx.drawImage(c, 0, 0, c.width, c.height, 0, 0, 9, 9)\n\n  console.log(nctx)\n}\n\nfunction addRect (style) {\n  layout.addRect(\n    Object.assign(style, {\n      lockMovementX: false,\n      lockRotation: false,\n      lockScalingX: false,\n      lockScalingY: false\n    }),\n    true,\n    true\n  )\n}\n\n// 阈值分割\nfunction adaptiveThreshold (canvasInput) {\n  let src = cv.imread(canvasInput)\n  let dst = new cv.Mat()\n  cv.cvtColor(src, src, cv.COLOR_RGBA2GRAY, 0)\n  cv.adaptiveThreshold(\n    src,\n    dst,\n    200,\n    cv.ADAPTIVE_THRESH_GAUSSIAN_C,\n    cv.THRESH_BINARY,\n    3,\n    2\n  )\n  let canvasOutput = Lab.ui.createCanvas()\n  cv.imshow(canvasOutput, dst)\n  src.delete()\n  dst.delete()\n  return canvasOutput\n}\n\nfunction test (canvasInput) {\n  let src = cv.imread(canvasInput)\n  let dst = new cv.Mat()\n  let gray = new cv.Mat()\n  let opening = new cv.Mat()\n  let coinsBg = new cv.Mat()\n  cv.cvtColor(src, gray, cv.COLOR_RGBA2GRAY, 0)\n  cv.threshold(gray, gray, 0, 255, cv.THRESH_BINARY_INV + cv.THRESH_OTSU)\n\n  // get background\n  let M = cv.Mat.ones(3, 3, cv.CV_8U)\n  cv.erode(gray, gray, M)\n  cv.dilate(gray, opening, M)\n  cv.dilate(opening, coinsBg, M, new cv.Point(-1, -1), 3)\n\n  let canvasOutput = Lab.ui.createCanvas()\n  cv.imshow(canvasOutput, coinsBg)\n\n  src.delete()\n  dst.delete()\n  gray.delete()\n  opening.delete()\n  coinsBg.delete()\n  M.delete()\n  return canvasOutput\n}\n",
  "code_length": 90,
  "size": [
    371,
    656
  ],
  "extname": "designlabplugin",
  "version": "0.2",
  "package_version": "0.1.2",
  "package_id": "df22ad54c8e3dee49e71dd4ce9538ee33b2a7d1e",
  "dependencies": {
    "@ffmpeg-installer/ffmpeg": "^1.0.20",
    "@ffprobe-installer/ffprobe": "^1.1.0",
    "@fortawesome/fontawesome-free": "^5.15.3",
    "@hapi/hapi": "^20.1.2",
    "@kilokilo/three-bmfont-text": "^3.1.0",
    "@mediapipe/camera_utils": "^0.3.1632432234",
    "@mediapipe/drawing_utils": "^0.3.1620248257",
    "@mediapipe/holistic": "^0.5.1635989137",
    "@node-rs/jieba": "^1.3.1",
    "@paddlejs-models/humanseg": "0.0.5",
    "@pixiv/three-vrm": "^0.6.7",
    "@tensorflow-models/body-pix": "^2.1.0",
    "@tensorflow-models/deeplab": "^0.2.1",
    "@tensorflow-models/face-landmarks-detection": "0.0.1",
    "@tensorflow-models/knn-classifier": "^1.2.2",
    "@tensorflow-models/mobilenet": "^2.1.0",
    "@tensorflow-models/posenet": "^2.2.2",
    "@tensorflow/tfjs": "^3.3.0",
    "@tensorflow/tfjs-backend-wasm": "^3.3.0",
    "about-window": "^1.14.0",
    "animejs": "^3.2.1",
    "color": "^3.1.3",
    "dat.gui": "^0.7.7",
    "debounce": "^1.2.1",
    "electron-json-storage": "^4.4.0",
    "electron-squirrel-startup": "^1.0.0",
    "emoji-picker-element": "^1.6.0",
    "emoji-regex": "^9.2.2",
    "espree": "^7.3.1",
    "exceljs": "^4.2.1",
    "face-api.js": "^0.22.2",
    "fluent-ffmpeg": "^2.1.2",
    "fomantic-ui": "^2.8.7",
    "gif.js": "^0.2.0",
    "gifuct-js": "^2.1.1",
    "horajs": "^0.1.3",
    "idb-kv-store": "^4.5.0",
    "internal-ip": "^6.2.0",
    "jimp": "^0.16.1",
    "kalidokit": "^1.0.5",
    "lowdb": "^1.0.0",
    "make-cert": "^1.2.0",
    "marked": "^1.2.9",
    "md5": "^2.3.0",
    "mime-types": "^2.1.30",
    "mkcert": "^1.4.0",
    "ml": "^6.0.0",
    "natural": "^5.0.3",
    "ngraph.path": "^1.3.1",
    "nouislider": "^14.7.0",
    "object-hash": "^2.1.1",
    "opencvjs-dist": "^4.4.0",
    "osc-js": "^2.1.2",
    "pdfjs-dist": "^2.6.347",
    "peer": "^0.6.1",
    "peerjs": "^1.3.2",
    "pixelit": "https://github.com/giventofly/pixelit.git",
    "recordrtc": "^5.6.2",
    "regl": "^2.1.0",
    "smartcrop": "^2.0.3",
    "socket.io": "^4.0.0",
    "socket.io-client": "^4.0.0",
    "three": "^0.134.0",
    "timeago.js": "^4.0.2",
    "unsplash-js": "^7.0.12",
    "wordcloud": "^1.2.2",
    "yoga-layout-wasm": "^1.9.3-alpha.7",
    "zdog": "^1.1.2"
  },
  "author": "shadow",
  "create_time": 1639549927607
}