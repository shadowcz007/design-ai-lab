{
  "id": "78d3e6e3994cda83b6eeb666effff63cd3223c7f",
  "poster": "data:image/png;base64,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",
  "title": "创意引擎",
  "knowledge": {
    "course": "- 变量\n- 优化ui\n- 基于svg模版的生成\n- ",
    "readme": "创意引擎",
    "author": "shadow",
    "version": "0.3.0"
  },
  "code": "var mainDiv, myCanvas, toolbox;\n\n// 保存坑位\nvar cardElements = {};\n\nvar _CANVAS_WIDTH = Math.min(window.innerWidth * 0.3, 300),\n    _CANVAS_HEIGHT = 300;\n\n\n// svg模版\nvar svgs=[];\n\nfunction gui() {\n    // 加载svg库\n    Lab.base.loadFromUrl('js','https://cdn.bootcdn.net/ajax/libs/svg.js/3.1.1/svg.min.js');\n\n    mainDiv = Lab.ui.createGroup('container');\n    Lab.ui.add(mainDiv);\n    mainDiv.style = 'width: 100%;';\n\n    mainDiv.innerHTML = `\n    <div class=\"ui two column divided grid\">\n        <div class=\"stretched row\">\n            <div class=\"column\">\n                <div class=\"ui segment\" id='myCanvas'></div>\n            </div>\n            <div class=\"column\" id=\"toolbox\"></div>\n        </div>\n    </div>\n    <div class=\"ui column divided grid\">\n        <div class=\"stretched row\">\n            <div class=\"column\" id='cards'></div>\n        </div>\n    </div>\n    `;\n\n \n    myCanvas = new Lab.Canvas(_CANVAS_WIDTH, _CANVAS_HEIGHT);\n    myCanvas.onModified = doModified;\n    myCanvas.onClick = doClick;\n    myCanvas.onRemoved = doRemoved;\n    mainDiv.querySelector('#myCanvas').appendChild(myCanvas.getElement())\n    \n\n    let cardsDiv = Lab.ui.createGroup('cards');\n    mainDiv.querySelector('#cards').appendChild(cardsDiv);\n\n    toolbox = createToolbox();\n    mainDiv.querySelector('#toolbox').appendChild(toolbox);\n\n\n    let addBtn = Lab.ui.createIcon('plus', () => {\n        Lab.ui.loading(0);\n        let { card, rect } = createCard(cardsDiv);\n        cardElements[card.id] = {\n            element: card,\n            rect: rect,\n            imgUrls: []\n        };\n        setTimeout(() => Lab.ui.loading(100), 200);\n    });\n    addBtn.classList.add('red');\n    addBtn.style = `\n    position:fixed;\n    right:12px;\n    top:240px;\n    `;\n\n\n\n    myCanvas.addRect({\n        left: 0,\n        top: 0,\n        width: _CANVAS_WIDTH,\n        height: _CANVAS_HEIGHT,\n        stroke: 'black',\n        fill: 'white'\n    },\n        false, true, true)\n    myCanvas.zoomToFitCanvas();\n\n    // 设定哪些变量要提取\n    let paramsInput=Lab.ui.createTextareaInput('变量设定',e=>{\n        console.log(e);\n    });\n\n    Lab.ui.add(paramsInput);\n\n    // 打开多个svg文件\n    let openBtn = Lab.ui.createButton('打开多个svg文件', () => {\n        Lab.ui.loading(0);\n        let datas=Lab.ui.openStringDialog(3);\n        console.log(datas);\n        let maskKeys=[];\n        for (const data of datas) {\n            let draw = SVG().addTo('body');\n            draw.__filepath=data.filepath;\n            draw.svg(data.data);\n            let parent=draw.children()[0];\n            let styles=parent.attr();\n            draw.width(styles.width);\n            draw.height(styles.height);\n            draw.viewbox(styles.viewBox);\n            svgs.push(draw);\n            // 预先提取变量\n            getAllMaskKeys(draw,ks=>{\n                Array.from(ks,k=>{\n                    if(!maskKeys.includes(k)) maskKeys.push(k);\n                });\n                paramsInput.setValue(maskKeys.join('\\n'));\n            });\n        };\n        setTimeout(() => Lab.ui.loading(100), 200);\n    });\n    Lab.ui.add(openBtn);\n\n    \n\n    // 预处理数据\n    let preDataBtn = Lab.ui.createButton('预处理', () => {\n        Lab.ui.loading(0);\n        let text=paramsInput.getValue();\n        if(text){\n            let keys=text.split('\\n').filter(f=>f);\n            if(keys){\n                window.keysList={};\n                for (const key of keys) {\n                    window.keysList[key]=[];\n                };\n                Array.from(svgs,s=>initEngine(s,keys));\n            }\n        }\n        // console.log(paramsInput.getValue())\n        // \n        setTimeout(() => Lab.ui.loading(100), 200);\n    });\n    Lab.ui.add(preDataBtn);\n\n\n    const clickAddImg = function() {\n        console.log(this)\n        myCanvas.addImg(this.node)\n      }\n    \n    // 打开基础模版，生成全部集合\n    let createBtn = Lab.ui.createButton('打开基础模版，生成全部集合', () => {\n        Lab.ui.loading(0);\n        let data=Lab.ui.openStringDialog(1);\n        if(window.result&&data){\n            let datas=[...Lab.base.shuffle(result)].slice(0,10);\n            for (const rs of datas) {\n                let draw = SVG().addTo('body');\n                draw.on('click', clickAddImg);\n                draw.svg(data.data);\n                let parent=draw.children()[0];\n                let styles=parent.attr();\n                draw.width(styles.width);\n                draw.height(styles.height);\n                draw.viewbox(styles.viewBox);\n                // window.draw=draw;\n                // 更改组件\n                for (const r of rs) {\n                    // 组件svg\n                    let element=window.keysList[r.key][r.index];\n                    draw.findOne('#'+r.key).svg(element.svg,true);\n                }\n            }\n        }\n         \n        setTimeout(() => Lab.ui.loading(100), 200);\n    });\n    Lab.ui.add(createBtn);\n};\n\nfunction createCard(row) {\n    let id = (new Date()).getTime() + '' + parseInt(Math.random() * 1000);\n\n    let card = Lab.ui.createGroup('card');\n    card.style.width = 'min-content';\n    card.addEventListener('click', e => {\n        setActiveObject(id);\n        toolbox.update();\n    });\n    card.id = id;\n    row.add(card);\n\n    let text = `图片集 ${1 + Object.keys(cardElements).length}`;\n    let t = Lab.ui.createBaseText(text);\n    card.add(t);\n    t.style.margin = '1em';\n\n    // img\n    let imgBtn = Lab.ui.createInput('imgs', text, (imgs) => {\n        Lab.ui.loading(0);\n        console.log(id, imgs)\n        if (cardElements[id]) cardElements[id].imgUrls = imgs;\n        setTimeout(() => Lab.ui.loading(100), 3000);\n    }, true, false);\n    card.add(imgBtn);\n\n    // emoji\n    let emojiDiv=Lab.ui.createGroup('column');\n    emojiDiv.style.display='flex';\n    let emojiBtn=Lab.ui.createIcon('plus',()=>{\n        let e=Lab.ui.createBaseText(Lab.base.shuffle(Lab.emoji.order())[0]);\n        emojiDiv.add(e);\n    });\n    emojiDiv.add(emojiBtn);\n     \n    card.add(emojiDiv);\n\n    // color\n    let colorDiv=Lab.ui.createGroup('column');\n    let colorBtn=Lab.ui.createIcon('plus',()=>{\n        let e=Lab.ui.createInput('color', text+colorDiv.children.length, (color) => {});\n        colorDiv.add(e);\n    });\n    colorDiv.add(colorBtn);\n     \n    card.add(colorDiv);\n\n     \n    // 选项框\n    let ins=Lab.ui.createInput('select','',e=>{\n        console.log(e);\n        \n    }, true, false );\n    ins.appendOptions([{\n        value:'img',\n        text:'图片'\n    },{\n        value:'emoji',\n        text:'表情'\n    },{\n        value:'color',\n        text:'色块'\n    }]);\n    card.add(ins);\n    ins.init();\n    ins.style.marginLeft='12px';\n\n\n    // \n    let rect = myCanvas.addRect({\n        left: parseInt(_CANVAS_WIDTH / 2) - 100,\n        top: parseInt(_CANVAS_HEIGHT / 2) - 100,\n        width: 100,\n        height: 100,\n        // stroke: 'red',\n        strokeWidth: 0,\n        fill: 'rgba(255,0,0,0.1)'\n    }, true, true, true)\n    // myCanvas.zoomToFitCanvas()\n    rect.id = id;\n\n    return { card, rect }\n}\n\nfunction createToolbox() {\n    let inPos = Lab.ui.createInputForPosition((pos) => {\n        // console.log(pos)\n        let [x, y, w, h] = pos;\n\n        let rect = myCanvas.getActiveObject();\n        rect.scaleToWidth(w);\n        rect.scaleToHeight(h);\n\n        rect.left = x;\n        rect.top = y;\n        // console.log(z);\n\n        rect.width = w / rect.scaleX;\n        rect.height = h / rect.scaleX;\n\n        myCanvas.render();\n    });\n    inPos.update = () => {\n        let rect = myCanvas.getActiveObject();\n        inPos.setValue([rect.left, rect.top, rect.getScaledWidth(), rect.getScaledHeight()]);\n    }\n    return inPos;\n}\n\n\nfunction doModified(e, data) {\n    // console.log(e, data)\n    // e.target.id;\n    if (e.target.id && cardElements[e.target.id]) {\n        toolbox.update();\n    }\n\n}\n\nfunction doClick(e) {\n    // console.log(e.target.id)\n    if (e.target.id && cardElements[e.target.id]) {\n        let card = cardElements[e.target.id];\n        // console.log(card, e.target.id)\n        card.element.classList.add('red');\n        // 更新rect信息到toolbox\n        toolbox.update();\n    } else {\n        for (const id in cardElements) {\n            cardElements[id].element.classList.remove('red');\n        };\n    }\n}\n\nfunction doRemoved(e) {\n    if (e.target.id && cardElements[e.target.id]) {\n        cardElements[e.target.id].element.remove();\n        delete cardElements[e.target.id];\n    };\n}\n\n// 激活\nfunction setActiveObject(id) {\n    for (const id in cardElements) {\n        cardElements[id].element.classList.remove('red');\n    };\n    if (cardElements[id]) {\n        let c = cardElements[id];\n        myCanvas.setActiveObject(c.rect);\n        c.element.classList.add('red');\n    };\n}\n\nfunction travel(children=[],doFun,successFun){\n    let isDone=false;\n    for(let c of children){\n        // console.log(c.node.id);\n        if(doFun) doFun(c)\n        if(c.children().length>0) {\n            isDone=false;\n            travel(c.children(),doFun,successFun);\n        }else{\n            isDone=true;\n        };\n    };\n    if(successFun&&isDone){\n        successFun();\n    }\n};\n\n// step 1 打开所有的模版\n// step 2 设定变量，预处理，提取变量对应的svg\n// step 3 导出数据\n\n\n// 得到变量，用-M标记的变量\nfunction getAllMaskKeys(draw,cb){\n    let maskKeys=[];\n    travel(draw.children(),child=>{\n        // 遍历过程中的数据处理\n        if (child.node.id&&child.node.id.trim()&&child.node.id.match('-M')&&!maskKeys.includes(child.node.id)){\n            maskKeys.push(child.node.id);\n        };\n\n    },()=>{\n        // 成功遍历完成\n       if(cb) cb(maskKeys);\n    });\n}\n\n// 初始化\n// keyList=['face','eyes','mouse','ears']\n// window.face=[];\n// window.eyes=[];\n// window.mouse=[];\n// window.ears=[];\nfunction initEngine(draw,keys=[]){\n    // 文件名\n    let basename=Lab.base.getBaseName(draw.__filepath);\n\n    travel(draw.children(),child=>{\n        // 遍历过程中的数据处理\n        if(keys.includes(child.node.id)&&window.keysList[child.node.id]){\n            let svg=child.svg(),\n                id=Lab.base.md5(svg);\n            let isNew=true;\n            for (const n of window.keysList[child.node.id]) {\n                if(n.id===id) isNew=false;\n            };\n            if(isNew){\n                window.keysList[child.node.id].push({\n                    id,svg,basename\n                });\n            }\n        }\n    },()=>{\n        // 成功遍历完成\n        let count=0,target=0;\n        for (const key in window.keysList) {\n            count+=window.keysList[key].length;\n            target+=svgs.length;\n        };\n        if(target&&count){\n            window.result=createAll();\n            console.log('succes',count/target,window.keysList,window.result);\n        };\n    });\n};\n\n\n// 笛卡尔生成全集\nfunction createAll(){\n    let data=[];\n    for (const key in window.keysList) {\n        data.push(Array.from(window.keysList[key],(d,i)=>{\n            return {\n                key:key,\n                index:i\n            }\n        }));\n    }\n    return Lab.base.cartesian(data);\n}\n",
  "code_length": 99,
  "size": [
    855,
    767
  ],
  "extname": "designlabplugin",
  "version": "0.3.0",
  "package_version": "0.1.2",
  "package_id": "cded8226092c2921490b94947d014f8989448189",
  "dependencies": {
    "@ffmpeg-installer/ffmpeg": "^1.0.20",
    "@ffprobe-installer/ffprobe": "^1.1.0",
    "@fortawesome/fontawesome-free": "^5.15.3",
    "@hapi/hapi": "^20.1.2",
    "@node-rs/jieba": "^1.3.1",
    "@paddlejs-models/humanseg": "0.0.5",
    "@tensorflow-models/body-pix": "^2.1.0",
    "@tensorflow-models/deeplab": "^0.2.1",
    "@tensorflow-models/face-landmarks-detection": "0.0.1",
    "@tensorflow-models/knn-classifier": "^1.2.2",
    "@tensorflow-models/mobilenet": "^2.1.0",
    "@tensorflow-models/posenet": "^2.2.2",
    "@tensorflow/tfjs": "^3.3.0",
    "@tensorflow/tfjs-backend-wasm": "^3.3.0",
    "about-window": "^1.14.0",
    "animejs": "^3.2.1",
    "color": "^3.1.3",
    "electron-json-storage": "^4.4.0",
    "electron-squirrel-startup": "^1.0.0",
    "emoji-picker-element": "^1.6.0",
    "emoji-regex": "^9.2.2",
    "espree": "^7.3.1",
    "exceljs": "^4.2.1",
    "face-api.js": "^0.22.2",
    "fluent-ffmpeg": "^2.1.2",
    "fomantic-ui": "^2.8.7",
    "gif.js": "^0.2.0",
    "gifuct-js": "^2.1.1",
    "horajs": "^0.1.3",
    "idb-kv-store": "^4.5.0",
    "internal-ip": "^6.2.0",
    "jimp": "^0.16.1",
    "lowdb": "^1.0.0",
    "make-cert": "^1.2.0",
    "marked": "^1.2.9",
    "md5": "^2.3.0",
    "mime-types": "^2.1.30",
    "mkcert": "^1.4.0",
    "ml": "^6.0.0",
    "natural": "^5.0.3",
    "ngraph.path": "^1.3.1",
    "nouislider": "^14.7.0",
    "object-hash": "^2.1.1",
    "opencvjs-dist": "^4.4.0",
    "osc-js": "^2.1.2",
    "pdfjs-dist": "^2.6.347",
    "peer": "^0.6.1",
    "peerjs": "^1.3.2",
    "pixelit": "https://github.com/giventofly/pixelit.git",
    "recordrtc": "^5.6.2",
    "regl": "^2.1.0",
    "smartcrop": "^2.0.3",
    "socket.io": "^4.0.0",
    "socket.io-client": "^4.0.0",
    "timeago.js": "^4.0.2",
    "unsplash-js": "^7.0.12",
    "wordcloud": "^1.2.2",
    "yoga-layout-wasm": "^1.9.3-alpha.7",
    "zdog": "^1.1.2"
  },
  "author": "shadow",
  "create_time": 1634300101625
}