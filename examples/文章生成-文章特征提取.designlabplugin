{
  "poster": "data:image/png;base64,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",
  "knowledge": {
    "course": "",
    "readme": "文章生成-文章特征提取",
    "author": "shadow",
    "version": "0.2"
  },
  "code": "var tagsIndex = [],\n    lines;\nvar tagsAll;\nvar dataset;\n\n\n// 用于生成文章\nvar goodDataSet = {},\n    goodDataSetIds = {};\n// 用于缓存数据集\nvar db = new Lab.Store('wenzhang');\n\n// UI\nvar mainDiv, detailDiv, cardsDiv,\n    mainBtn,\n    mainBtns,\n    loadBtn,\n    allBtn,\n    addBtn,\n    downloadDatasetBtn,\n    openDatasetBtn;\n\n// 输入\nvar userInputText;\n\nfunction gui() {\n    Lab.ui.p5Show(false);\n\n    mainDiv = Lab.ui.createGroup();\n    mainDiv.style = `width: 100%;\n    height: 100vh;\n    display: flex;`;\n    Lab.ui.add(mainDiv);\n\n    createNewBtn = Lab.ui.createButton('生成', createNew);\n    // 添加数据\n    addBtn = Lab.ui.createButton('标注', addData, false);\n\n\n    moreTextsBtns = Lab.ui.createModel('更多语料', '');\n    Lab.ui.add(moreTextsBtns);\n\n    let inputText = Lab.ui.createInput('text', '', e => {\n        if(e[0]) userInputText=e[0];\n    }, true, false);\n    let mTitles = Lab.ui.createButton('标题',async () => {\n        Lab.ui.loading(0);\n        $(moreTextsBtns).modal('hide');\n        if(userInputText){\n           let ts= await moreTitlesFromBaidu(userInputText);\n           detailDiv.querySelector('.text').innerText = ts.join('\\n\\n');\n        };\n        Lab.ui.loading(100);\n    }, false);\n    moreTextsBtns.add(inputText);\n    moreTextsBtns.add(mTitles);\n\n    // 更多标题\n    moreTextsBtn = Lab.ui.createButton('更多语料', () => $(moreTextsBtns).modal('show'), false);\n\n    detailDiv = Lab.ui.createGroup();\n    detailDiv.class = 'detail';\n    detailDiv.style = `\n    width: 40%;\n    background: rgb(220, 220, 247);\n    height: 100vh;\n    overflow: scroll;\n    padding: 12px;`;\n    detailDiv.innerHTML = `\n    <div class='tags' style='padding: 16px;'></div>\n    <div class='similar'></div>\n    <div class='text' contenteditable=\"true\" style='padding: 12px;'></div>\n    `;\n    detailDiv.insertBefore(moreTextsBtn, detailDiv.childNodes[0]);\n    detailDiv.insertBefore(addBtn, detailDiv.childNodes[0]);\n    detailDiv.insertBefore(createNewBtn, detailDiv.childNodes[0]);\n\n\n    mainDiv.add(detailDiv);\n\n\n\n    cardsDiv = Lab.ui.createGroup();\n    cardsDiv.class = 'cards';\n    cardsDiv.style = `\n    width: 60%;\n    background: rgb(247, 220, 241);\n    height: 100vh;\n    overflow: scroll;\n    display: flex;\n    flex-wrap: wrap;`;\n    mainDiv.add(cardsDiv);\n\n\n    // \n    mainBtn = Lab.ui.createIcon('settings', () => $(mainBtns).modal('show'));\n    mainBtn.style = `position: fixed;\n    top: 12px;\n    right: 12px;\n    z-index: 999;`;\n\n\n    mainBtns = Lab.ui.createModel('功能', '');\n    Lab.ui.add(mainBtns);\n\n    // 剪切板粘贴\n    let pasteBtn = Lab.ui.createButton('从剪切板粘贴', () => {\n        let text = Lab.clipboard.read('text');\n        // console.log(text)\n        let tx = text.split('\\n').filter(f => f);\n        doDataFromText(tx);\n    }, false);\n\n\n    // 加载文件\n    loadBtn = Lab.ui.createButton('打开excel文件', async () => {\n        let filepaths = Lab.ui.getFilePath(1, '打开excel');\n        if (filepaths && filepaths[0]) {\n            // loadBtn.innerText = '已打开';\n            let fp = filepaths[0];\n            let res = await Lab.excel.readFromFile(fp);\n            doData(res);\n        };\n        $(mainBtns).modal('hide');\n    }, false);\n    // loadBtn.style = `position: fixed;\n    // top: 12px;\n    // right: 12px;\n    // z-index: 999;`;\n\n    // 显示所有文章\n    allBtn = Lab.ui.createButton('全部', createCards, false);\n    // allBtn.style = `position: fixed;\n    // top: 56px;\n    // right: 12px;\n    // z-index: 999;`;\n\n\n    // addBtn.style = `position: fixed;\n    // top: 100px;\n    // right: 12px;\n    // z-index: 999;`;\n\n    // 保存数据集到本地\n    downloadDatasetBtn = Lab.ui.createButton('保存', () => {\n        Lab.ui.saveJsonDialog(goodDataSet, '保存数据集');\n        $(mainBtns).modal('hide');\n    }, false);\n    // downloadDatasetBtn.style = `position: fixed;\n    // top: 144px;\n    // right: 12px;\n    // z-index: 999;`;\n\n    // 加载本地数据集\n    openDatasetBtn = Lab.ui.createButton('加载', () => {\n        goodDataSet = Lab.ui.openJsonDialog();\n        createTags();\n        $(mainBtns).modal('hide');\n    }, false);\n    // openDatasetBtn.style = `position: fixed;\n    // top: 188px;\n    // right: 12px;\n    // z-index: 999;`;\n\n    // 剪切板粘贴\n    let resetBtn = Lab.ui.createButton('重置', () => {\n        // 重置\n        goodDataSet = {};\n        goodDataSetIds = {};\n        createTags();\n        $(mainBtns).modal('hide');\n    }, false);\n\n    mainBtns.add(loadBtn);\n    mainBtns.add(pasteBtn);\n    mainBtns.add(allBtn);\n    // mainBtns.querySelector('.content').appendChild(addBtn);\n    mainBtns.add(downloadDatasetBtn);\n    mainBtns.add(openDatasetBtn);\n    mainBtns.add(resetBtn);\n\n\n    // 加载本地缓存\n    db.getJson().then(obj => {\n        goodDataSetIds = obj.goodDataSetIds;\n        goodDataSet = obj.goodDataSet;\n        console.log('加载成功');\n        // detailDiv.\n        createTags();\n    });\n};\n\nasync function doData(data) {\n    Lab.ui.loading(0);\n    await Lab.base.sleep(500);\n    detailDiv.querySelector('.text').innerText = '';\n    // 重置\n    // goodDataSet = {};\n    // goodDataSetIds = {};\n    // createTags();\n    // 第一列是文本数据，其他列是补充的其他字段信息\n    // console.log(data)\n    let columns = data.worksheets[0].columns;\n    let ds = new Array(columns.length);\n    for (let index = 0; index < columns.length; index++) {\n        let c = columns[index];\n        let values = Array.from(c.values, v => v).filter(f => f !== undefined);\n        // console.log(values)\n        let name = values[0];\n        values = values.slice(1, values.length);\n        let list = Array.from(values, v => v);\n        ds[index] = { name, data: list };\n        // ds[index].tags = extractTagsFromText(list);\n    };\n    // console.log(ds)\n    dataset = extractTagsFromText(ds[0].data);\n\n    for (let index = 1; index < ds.length; index++) {\n        let name = ds[index].name,\n            dss = ds[index].data;\n\n        for (let i = 0; i < dataset.length; i++) {\n            if (!dataset[i].ext) dataset[i].ext = {};\n            dataset[i].ext[name] = dss[i];\n        }\n    };\n\n    // 计算总的tag排名\n    tagsAll = tagsRank();\n\n    createCards();\n\n    createTagsAll();\n\n    Lab.ui.loading(100);\n};\n\n\n\nasync function doDataFromText(data) {\n    Lab.ui.loading(0);\n    await Lab.base.sleep(500);\n    detailDiv.querySelector('.text').innerText = '';\n    // 重置\n    // goodDataSet = {};\n    // goodDataSetIds = {};\n    // createTags();\n    // 第一列是文本数据，其他列是补充的其他字段信息\n    // console.log(data)\n    // let columns = data.worksheets[0].columns;\n    let ds = [{\n        name: 'd',\n        data: data\n    }];\n\n    // console.log(ds)\n    dataset = extractTagsFromText(ds[0].data);\n\n    for (let index = 1; index < ds.length; index++) {\n        let name = ds[index].name,\n            dss = ds[index].data;\n\n        for (let i = 0; i < dataset.length; i++) {\n            if (!dataset[i].ext) dataset[i].ext = {};\n            dataset[i].ext[name] = dss[i];\n        }\n    };\n\n    // 计算总的tag排名\n    tagsAll = tagsRank();\n\n    createCards();\n\n    createTagsAll();\n\n    Lab.ui.loading(100);\n};\n\nfunction extractTagsFromText(data) {\n    return Array.from(data, (t, i) => {\n        let id = i;\n        let tags = Lab.nlp.jieba.extract(t, 5);\n        let sum = eval(Array.from(tags, t => t.weight).join('+'));\n        tags = Array.from(tags, tag => {\n            tag.weight = tag.weight / sum;\n            tagsIndex.push({\n                id,\n                tag: tag.keyword,\n                weight: tag.weight\n            });\n            return tag\n        });\n        return { tags, text: t, id };\n    });\n\n};\n\n\n// 全局标签计算\nfunction tagsRank() {\n    let tagsAll = {};\n    Array.from(dataset, d => d.tags).flat(Infinity).forEach(t => {\n        if (!tagsAll[t.keyword] && tagsAll[t.keyword] !== 0) tagsAll[t.keyword] = 0;\n        tagsAll[t.keyword] += t.weight;\n    });\n\n    let tags = [];\n    for (const tag in tagsAll) {\n        if (!(parseInt(tag) > 0)) tags.push({\n            weight: tagsAll[tag],\n            tag: tag\n        });\n    };\n    tags = tags.sort((a, b) => b.weight - a.weight);\n    return tags\n}\n\nfunction addData() {\n    let text = detailDiv.querySelector('.text').innerText;\n    // console.log(text)\n    let texts = Array.from(text.split('#').filter(f => f), s => {\n        s = s.split('\\n');\n        return { tag: s[0].trim(), text: s[1].trim() }\n    }).filter(f => f.text && f.tag);\n\n    for (const text of texts) {\n        if (!goodDataSet[text.tag]) {\n            goodDataSet[text.tag] = [];\n        };\n        let id = Lab.base.hash(text);\n        if (!goodDataSetIds[id] && text.text) {\n            goodDataSetIds[id] = true;\n            goodDataSet[text.tag].push(text.text)\n        };\n    };\n\n    db.set('goodDataSet', goodDataSet).then(() => {\n        createTags();\n        db.set('goodDataSetIds', goodDataSetIds);\n\n        $(mainBtns).modal('hide');\n    });\n};\n\n// 所有的标签\nfunction createTagsAll() {\n    // tagsAll\n\n    let topN = Lab.ui.createTags(Array.from(tagsAll.slice(0, 10), t => t.tag)),\n        bottomN = Lab.ui.createTags(Array.from(tagsAll.slice(tagsAll.length - 10, tagsAll.length), t => t.tag)),\n        otherN = Lab.ui.createTags(Array.from(tagsAll.slice(10, tagsAll.length - 10), t => t.tag));\n    // console.log(topN)\n    let data = [{\n        active: true,\n        title: 'TOP10',\n        data: Array.from(topN.children, c => c.outerHTML)\n    }];\n    if (bottomN.children.length > 0) data.push({\n        active: false,\n        title: 'BOTTOMN',\n        data: Array.from(bottomN.children, c => c.outerHTML)\n    });\n    if (otherN.children.length > 0) data.push({\n        active: false,\n        title: '其他',\n        data: Array.from(otherN.children, c => c.outerHTML)\n    });\n\n    let div = Lab.ui.createAccordion(data);\n    Array.from(div.querySelectorAll('.label'), b => {\n        b.addEventListener('click', e => {\n            console.log(b.innerText);\n            matchCardByTag(-1, b.innerText);\n        });\n    })\n    detailDiv.querySelector('.tags').innerHTML = '';\n    detailDiv.querySelector('.tags').appendChild(div);\n    // return div\n}\n\n// 创建文章特征\nfunction createCard(id, text, tags) {\n    let g = Lab.ui.createGroup();\n    g.style = `\n    outline: black solid 1px;\n    margin: 12px;\n    width: max-content;\n    height: fit-content;\n    min-width: 128px;\n    text-align: left;\n    padding: 12px 8px;\n    display: flex;\n    background-color: #eee;\n    flex-direction: column;\n    justify-content: space-between;\n    `;\n\n    for (const tag of tags) {\n        let textDom = Lab.ui.createBaseText(tag.keyword);\n        textDom.style = `\n        font-size:${120 * tag.weight}px;\n        line-height:${4 + (120 * tag.weight)}px;\n        margin: 0px;\n        padding: 0;\n        display: block;`;\n        g.appendChild(textDom);\n        textDom.addEventListener('click', e => {\n            matchCardByTag(id, tag.keyword);\n        });\n    };\n\n    let btn = Lab.ui.createButton('更多', async () => {\n        let obj = dataset.filter(d => d.id === id)[0];\n        // console.log(obj)\n        detailDiv.querySelector('.text').innerText = text;\n        if (obj && obj.ext) detailDiv.querySelector('.text').innerText += '\\n' + JSON.stringify(obj.ext, null, 2);\n    }, false);\n    btn.classList.add('small');\n    g.appendChild(btn);\n\n    return g;\n};\n\nasync function createCards() {\n    $(mainBtns).modal('hide');\n    if (!dataset) return;\n    Lab.ui.loading(0);\n    await Lab.base.sleep(200);\n    cardsDiv.innerHTML = '';\n    let div = document.createDocumentFragment();\n    for (const d of dataset) {\n        let g = createCard(d.id, d.text, d.tags);\n        div.appendChild(g);\n    };\n    cardsDiv.appendChild(div);\n    Lab.ui.loading(100);\n}\n\n\nfunction createTags() {\n    detailDiv.querySelector('.tags').innerHTML = '';\n\n    let items = [];\n\n    for (let tag in goodDataSet) {\n        if (goodDataSet[tag] && goodDataSet[tag].length > 0) {\n            items.push({\n                index: tag === '开头' ? 0 : (tag === '结尾' ? Object.keys(goodDataSet).length + 99 : 1),\n                tag: tag,\n                length: goodDataSet[tag].length\n            });\n        }\n    };\n\n    items = items.sort((a, b) => (a.index - b.index));\n    items = Array.from(items, t => `<div class=\"ui checked checkbox\">\n            <input type=\"checkbox\" checked=\"\" data-tag='${t.tag}'>\n            <label>${t.tag} ${t.length}</label>\n        </div>`);\n\n    detailDiv.querySelector('.tags').appendChild(Lab.ui.createList(items))\n\n}\n\nfunction createNew() {\n    let tags = Array.from(Array.from(detailDiv.querySelectorAll('input'), c => c).filter(c => c.checked), a => a.getAttribute('data-tag'));\n\n    let res = Array.from(Lab.base.cartesian(\n        Array.from(tags, t => goodDataSet[t])\n    ), d => d.join('\\n'));\n\n    res = Lab.base.shuffle(res);\n    // console.log(res.join('\\n-------------\\n'))\n    detailDiv.querySelector('.text').innerText = res[0];\n}\n\n// 匹配选择的tag\nfunction matchCardByTag(id = -1, tag = '') {\n    let matchs = tagsIndex.filter(t => t.tag === tag && t.id !== id);\n    matchs = matchs.sort((a, b) => b.weight - a.weight);\n    // console.log(id, matchs);\n    let idsIndex = {};\n\n    let newData = dataset.filter(d => d.id === id);\n    for (const m of matchs) {\n        newData = [...newData, ...dataset.filter(d => d.id === m.id)];\n    };\n\n    cardsDiv.innerHTML = '';\n    for (const d of newData) {\n        if (!idsIndex[d.id]) {\n            let g = createCard(d.id, d.text, d.tags);\n            cardsDiv.appendChild(g);\n            idsIndex[d.id] = true;\n        }\n    }\n}\n\n// new LeaderLine(\n//   document.getElementById('start'),\n//   document.getElementById('end')\n// );\n// \nfunction getFromBaidu(word) {\n    return new Promise((resolve, reject) => {\n        let web = document.createElement('webview');\n        web.style.display = 'none';\n        Lab.ui.add(web);\n        web.src = 'https://www.baidu.com/s?rtt=1&bsst=1&cl=2&tn=news&ie=utf-8&word=' + encodeURI(word);\n        web.addEventListener('did-finish-load', async (e) => {\n            let obj = await web.executeJavaScript(`\n                var nums=document.body.querySelector('#header_top_bar .nums').innerText;\n                var titles=Array.from(document.querySelectorAll('h3'),h=>h.innerText);\n                var obj={nums,titles};\n                obj`);\n            // console.log(obj)\n            // let res = Lab.nlp.jieba.tag(obj.nums.replace(/\\,/ig, ''));\n            web.remove();\n            resolve(obj);\n        })\n    })\n}\n\n// 更多标题语料\nasync function moreTitlesFromBaidu(word) {\n    let obj = await getFromBaidu(word);\n    return obj.titles\n};\n\n// 词频\nasync function getKeywordHotIndexFromBaidu(word) {\n    let obj = await getFromBaidu(word);\n    let res = Lab.nlp.jieba.tag(obj.nums.replace(/\\,/ig, ''));\n    res = res.filter(f => f.tag === 'm');\n    if (res[0]) {\n        return parseInt(res[0].word) || 0;\n    }\n    return 0\n}",
  "code_length": 184,
  "size": [
    685,
    800
  ],
  "extname": "designlabplugin",
  "version": "0.2",
  "package_version": "0.1.2",
  "package_id": "9b7e4f0a363085fd979ab91289b7a4798ba35f0f",
  "dependencies": {
    "@ffmpeg-installer/ffmpeg": "^1.0.20",
    "@ffprobe-installer/ffprobe": "^1.1.0",
    "@fortawesome/fontawesome-free": "^5.15.3",
    "@hapi/hapi": "^20.1.2",
    "@node-rs/jieba": "^1.1.0",
    "@paddlejs-models/humanseg": "0.0.5",
    "@tensorflow-models/body-pix": "^2.1.0",
    "@tensorflow-models/deeplab": "^0.2.1",
    "@tensorflow-models/face-landmarks-detection": "0.0.1",
    "@tensorflow-models/knn-classifier": "^1.2.2",
    "@tensorflow-models/mobilenet": "^2.1.0",
    "@tensorflow-models/posenet": "^2.2.2",
    "@tensorflow/tfjs": "^3.3.0",
    "@tensorflow/tfjs-backend-wasm": "^3.3.0",
    "@tensorflow/tfjs-converter": "^2.8.6",
    "@tensorflow/tfjs-node": "^3.3.0",
    "about-window": "^1.14.0",
    "blockly": "^4.20201217.0",
    "color": "^3.1.3",
    "colorthief": "^2.3.2",
    "electron-json-storage": "^4.4.0",
    "escodegen": "^2.0.0",
    "espree": "^7.3.1",
    "estraverse": "^5.2.0",
    "exceljs": "^4.2.1",
    "fabric": "^4.3.1",
    "fluent-ffmpeg": "^2.1.2",
    "fomantic-ui": "^2.8.7",
    "gif.js": "^0.2.0",
    "gifuct-js": "^2.1.1",
    "idb-kv-store": "^4.5.0",
    "internal-ip": "^6.2.0",
    "jimp": "^0.16.1",
    "leader-line": "^1.0.5",
    "lowdb": "^1.0.0",
    "make-cert": "^1.2.0",
    "marked": "^1.2.9",
    "md5": "^2.3.0",
    "mime-types": "^2.1.30",
    "mkcert": "^1.4.0",
    "monaco-editor": "^0.21.3",
    "muuri": "^0.9.3",
    "ngraph.path": "^1.3.1",
    "nouislider": "^14.7.0",
    "object-hash": "^2.1.1",
    "opencvjs-dist": "^4.4.0",
    "p5": "^1.3.1",
    "p5.createloop": "^0.2.8",
    "pdfjs-dist": "^2.6.347",
    "peer": "^0.6.1",
    "peerjs": "^1.3.2",
    "recordrtc": "^5.6.2",
    "smartcrop": "^2.0.3",
    "socket.io": "^4.0.0",
    "socket.io-client": "^4.0.0",
    "spatial-db": "0.0.25",
    "sweetalert2": "^10.15.7",
    "timeago.js": "^4.0.2",
    "wordcloud": "^1.2.2",
    "yoga-layout-wasm": "^1.9.3-alpha.7"
  },
  "author": "shadow",
  "create_time": 1623723947708
}