{
  "poster": "data:image/png;base64,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",
  "knowledge": {
    "course": "",
    "readme": "文章生成-文章特征提取",
    "author": "shadow",
    "version": "0.1"
  },
  "code": "var tagsIndex = [],\n    lines;\nvar tagsAll;\nvar dataset;\n\n\n// 用于生成文章\nvar goodDataSet = {},\n    goodDataSetIds = {};\n// 用于缓存数据集\nvar db = new Lab.Store('wenzhang');\n\n// UI\nvar mainDiv, detailDiv, cardsDiv,\n    mainBtn,\n    mainBtns,\n    loadBtn,\n    allBtn,\n    addBtn,\n    downloadDatasetBtn,\n    openDatasetBtn;\n\nfunction gui() {\n    Lab.ui.p5Show(false);\n\n    mainDiv = Lab.ui.createGroup();\n    mainDiv.style = `width: 100%;\n    height: 100vh;\n    display: flex;`;\n    Lab.ui.add(mainDiv);\n\n    createNewBtn = Lab.ui.createButton('生成', createNew);\n    // 添加数据\n    addBtn = Lab.ui.createButton('标注', addData, false);\n\n    detailDiv = Lab.ui.createGroup();\n    detailDiv.class = 'detail';\n    detailDiv.style = `\n    width: 40%;\n    background: rgb(220, 220, 247);\n    height: 100vh;\n    overflow: scroll;\n    padding: 12px;`;\n    detailDiv.innerHTML = `\n    <div class='tags' style='padding: 16px;'></div>\n    <div class='similar'></div>\n    <div class='text' contenteditable=\"true\" style='padding: 12px;'></div>\n    `;\n    detailDiv.insertBefore(addBtn, detailDiv.childNodes[0]);\n    detailDiv.insertBefore(createNewBtn, detailDiv.childNodes[0]);\n\n\n    mainDiv.add(detailDiv);\n\n\n\n    cardsDiv = Lab.ui.createGroup();\n    cardsDiv.class = 'cards';\n    cardsDiv.style = `\n    width: 60%;\n    background: rgb(247, 220, 241);\n    height: 100vh;\n    overflow: scroll;\n    display: flex;\n    flex-wrap: wrap;`;\n    mainDiv.add(cardsDiv);\n\n\n    // \n    mainBtn = Lab.ui.createIcon('settings', () => $(mainBtns).modal('show'));\n    mainBtn.style = `position: fixed;\n    top: 12px;\n    right: 12px;\n    z-index: 999;`;\n\n\n    mainBtns = Lab.ui.createModel('功能', '');\n    Lab.ui.add(mainBtns);\n\n    // 剪切板粘贴\n    let pasteBtn = Lab.ui.createButton('从剪切板粘贴', () => {\n        let text = Lab.clipboard.read('text');\n        // console.log(text)\n        let tx = text.split('\\n').filter(f => f);\n        doDataFromText(tx);\n    }, false);\n\n\n    // 加载文件\n    loadBtn = Lab.ui.createButton('打开excel文件', async() => {\n        let filepaths = Lab.ui.getFilePath(1, '打开excel');\n        if (filepaths && filepaths[0]) {\n            // loadBtn.innerText = '已打开';\n            let fp = filepaths[0];\n            let res = await Lab.excel.readFromFile(fp);\n            doData(res);\n        };\n        $(mainBtns).modal('hide');\n    }, false);\n    // loadBtn.style = `position: fixed;\n    // top: 12px;\n    // right: 12px;\n    // z-index: 999;`;\n\n    // 显示所有文章\n    allBtn = Lab.ui.createButton('全部', createCards, false);\n    // allBtn.style = `position: fixed;\n    // top: 56px;\n    // right: 12px;\n    // z-index: 999;`;\n\n\n    // addBtn.style = `position: fixed;\n    // top: 100px;\n    // right: 12px;\n    // z-index: 999;`;\n\n    // 保存数据集到本地\n    downloadDatasetBtn = Lab.ui.createButton('保存', () => {\n        Lab.ui.saveJsonDialog(goodDataSet, '保存数据集');\n        $(mainBtns).modal('hide');\n    }, false);\n    // downloadDatasetBtn.style = `position: fixed;\n    // top: 144px;\n    // right: 12px;\n    // z-index: 999;`;\n\n    // 加载本地数据集\n    openDatasetBtn = Lab.ui.createButton('加载', () => {\n        Lab.ui.openJsonDialog();\n        $(mainBtns).modal('hide');\n    }, false);\n    // openDatasetBtn.style = `position: fixed;\n    // top: 188px;\n    // right: 12px;\n    // z-index: 999;`;\n\n    // 剪切板粘贴\n    let resetBtn = Lab.ui.createButton('重置', () => {\n        // 重置\n        goodDataSet = {};\n        goodDataSetIds = {};\n        createTags();\n    }, false);\n\n    mainBtns.querySelector('.content').appendChild(loadBtn);\n    mainBtns.querySelector('.content').appendChild(pasteBtn);\n    mainBtns.querySelector('.content').appendChild(allBtn);\n    // mainBtns.querySelector('.content').appendChild(addBtn);\n    mainBtns.querySelector('.content').appendChild(downloadDatasetBtn);\n    mainBtns.querySelector('.content').appendChild(openDatasetBtn);\n    mainBtns.querySelector('.content').appendChild(resetBtn);\n\n\n    // 加载本地缓存\n    db.getJson().then(obj => {\n        goodDataSetIds = obj.goodDataSetIds;\n        goodDataSet = obj.goodDataSet;\n        console.log('加载成功');\n        // detailDiv.\n        createTags();\n    });\n};\n\nasync function doData(data) {\n    Lab.ui.loading(0);\n    await Lab.base.sleep(500);\n    detailDiv.querySelector('.text').innerText = '';\n    // 重置\n    // goodDataSet = {};\n    // goodDataSetIds = {};\n    // createTags();\n    // 第一列是文本数据，其他列是补充的其他字段信息\n    // console.log(data)\n    let columns = data.worksheets[0].columns;\n    let ds = new Array(columns.length);\n    for (let index = 0; index < columns.length; index++) {\n        let c = columns[index];\n        let values = Array.from(c.values, v => v).filter(f => f !== undefined);\n        // console.log(values)\n        let name = values[0];\n        values = values.slice(1, values.length);\n        let list = Array.from(values, v => v);\n        ds[index] = { name, data: list };\n        // ds[index].tags = extractTagsFromText(list);\n    };\n    // console.log(ds)\n    dataset = extractTagsFromText(ds[0].data);\n\n    for (let index = 1; index < ds.length; index++) {\n        let name = ds[index].name,\n            dss = ds[index].data;\n\n        for (let i = 0; i < dataset.length; i++) {\n            if (!dataset[i].ext) dataset[i].ext = {};\n            dataset[i].ext[name] = dss[i];\n        }\n    };\n\n    // 计算总的tag排名\n    tagsAll = tagsRank();\n\n    createCards();\n\n    createTagsAll();\n\n    Lab.ui.loading(100);\n};\n\n\n\nasync function doDataFromText(data) {\n    Lab.ui.loading(0);\n    await Lab.base.sleep(500);\n    detailDiv.querySelector('.text').innerText = '';\n    // 重置\n    // goodDataSet = {};\n    // goodDataSetIds = {};\n    // createTags();\n    // 第一列是文本数据，其他列是补充的其他字段信息\n    // console.log(data)\n    // let columns = data.worksheets[0].columns;\n    let ds = [{\n        name: 'd',\n        data: data\n    }];\n\n    // console.log(ds)\n    dataset = extractTagsFromText(ds[0].data);\n\n    for (let index = 1; index < ds.length; index++) {\n        let name = ds[index].name,\n            dss = ds[index].data;\n\n        for (let i = 0; i < dataset.length; i++) {\n            if (!dataset[i].ext) dataset[i].ext = {};\n            dataset[i].ext[name] = dss[i];\n        }\n    };\n\n    // 计算总的tag排名\n    tagsAll = tagsRank();\n\n    createCards();\n\n    createTagsAll();\n\n    Lab.ui.loading(100);\n};\n\nfunction extractTagsFromText(data) {\n    return Array.from(data, (t, i) => {\n        let id = i;\n        let tags = Lab.nlp.jieba.extract(t, 5);\n        let sum = eval(Array.from(tags, t => t.weight).join('+'));\n        tags = Array.from(tags, tag => {\n            tag.weight = tag.weight / sum;\n            tagsIndex.push({\n                id,\n                tag: tag.keyword,\n                weight: tag.weight\n            });\n            return tag\n        });\n        return { tags, text: t, id };\n    });\n\n};\n\n\n// 全局标签计算\nfunction tagsRank() {\n    let tagsAll = {};\n    Array.from(dataset, d => d.tags).flat(Infinity).forEach(t => {\n        if (!tagsAll[t.keyword] && tagsAll[t.keyword] !== 0) tagsAll[t.keyword] = 0;\n        tagsAll[t.keyword] += t.weight;\n    });\n\n    let tags = [];\n    for (const tag in tagsAll) {\n        if (!(parseInt(tag) > 0)) tags.push({\n            weight: tagsAll[tag],\n            tag: tag\n        });\n    };\n    tags = tags.sort((a, b) => b.weight - a.weight);\n    return tags\n}\n\nfunction addData() {\n    let text = detailDiv.querySelector('.text').innerText;\n    // console.log(text)\n    let texts = Array.from(text.split('#').filter(f => f), s => {\n        s = s.split('\\n');\n        return { tag: s[0].trim(), text: s[1].trim() }\n    }).filter(f => f.text && f.tag);\n\n    for (const text of texts) {\n        if (!goodDataSet[text.tag]) {\n            goodDataSet[text.tag] = [];\n        };\n        let id = Lab.base.hash(text);\n        if (!goodDataSetIds[id] && text.text) {\n            goodDataSetIds[id] = true;\n            goodDataSet[text.tag].push(text.text)\n        };\n    };\n\n    db.set('goodDataSet', goodDataSet).then(() => {\n        createTags();\n        db.set('goodDataSetIds', goodDataSetIds);\n\n        $(mainBtns).modal('hide');\n    });\n};\n\n// 所有的标签\nfunction createTagsAll() {\n    // tagsAll\n\n    let topN = Lab.ui.createTags(Array.from(tagsAll.slice(0, 10), t => t.tag)),\n        bottomN = Lab.ui.createTags(Array.from(tagsAll.slice(tagsAll.length - 10, tagsAll.length), t => t.tag)),\n        otherN = Lab.ui.createTags(Array.from(tagsAll.slice(10, tagsAll.length - 10), t => t.tag));\n    // console.log(topN)\n    let data = [{\n        active: true,\n        title: 'TOP10',\n        data: Array.from(topN.children, c => c.outerHTML)\n    }];\n    if (bottomN.children.length > 0) data.push({\n        active: false,\n        title: 'BOTTOMN',\n        data: Array.from(bottomN.children, c => c.outerHTML)\n    });\n    if (otherN.children.length > 0) data.push({\n        active: false,\n        title: '其他',\n        data: Array.from(otherN.children, c => c.outerHTML)\n    });\n\n    let div = Lab.ui.createAccordion(data);\n    Array.from(div.querySelectorAll('.label'), b => {\n        b.addEventListener('click', e => {\n            console.log(b.innerText);\n            matchCardByTag(-1, b.innerText);\n        });\n    })\n    detailDiv.querySelector('.tags').innerHTML = '';\n    detailDiv.querySelector('.tags').appendChild(div);\n    // return div\n}\n\n// 创建文章特征\nfunction createCard(id, text, tags) {\n    let g = Lab.ui.createGroup();\n    g.style = `\n    outline: black solid 1px;\n    margin: 12px;\n    width: max-content;\n    height: fit-content;\n    min-width: 128px;\n    text-align: left;\n    padding: 12px 8px;\n    display: flex;\n    background-color: #eee;\n    flex-direction: column;\n    justify-content: space-between;\n    `;\n\n    for (const tag of tags) {\n        let textDom = Lab.ui.createBaseText(tag.keyword);\n        textDom.style = `\n        font-size:${120 * tag.weight}px;\n        line-height:${4 + (120 * tag.weight)}px;\n        margin: 0px;\n        padding: 0;\n        display: block;`;\n        g.appendChild(textDom);\n        textDom.addEventListener('click', e => {\n            matchCardByTag(id, tag.keyword);\n        });\n    };\n\n    let btn = Lab.ui.createButton('更多', async() => {\n        let obj = dataset.filter(d => d.id === id)[0];\n        // console.log(obj)\n        detailDiv.querySelector('.text').innerText = text;\n        if (obj && obj.ext) detailDiv.querySelector('.text').innerText += '\\n' + JSON.stringify(obj.ext, null, 2);\n    }, false);\n    btn.classList.add('small');\n    g.appendChild(btn);\n\n    return g;\n};\n\nasync function createCards() {\n    $(mainBtns).modal('hide');\n    if (!dataset) return;\n    Lab.ui.loading(0);\n    await Lab.base.sleep(200);\n    cardsDiv.innerHTML = '';\n    let div = document.createDocumentFragment();\n    for (const d of dataset) {\n        let g = createCard(d.id, d.text, d.tags);\n        div.appendChild(g);\n    };\n    cardsDiv.appendChild(div);\n    Lab.ui.loading(100);\n}\n\n\nfunction createTags() {\n    detailDiv.querySelector('.tags').innerHTML = '';\n\n    let items = [];\n\n    for (let tag in goodDataSet) {\n        if (goodDataSet[tag] && goodDataSet[tag].length > 0) {\n            items.push({\n                index: tag === '开头' ? 0 : (tag === '结尾' ? Object.keys(goodDataSet).length + 99 : 1),\n                tag: tag,\n                length: goodDataSet[tag].length\n            });\n        }\n    };\n\n    items = items.sort((a, b) => (a.index - b.index));\n    items = Array.from(items, t => `<div class=\"ui checked checkbox\">\n            <input type=\"checkbox\" checked=\"\" data-tag='${t.tag}'>\n            <label>${t.tag} ${t.length}</label>\n        </div>`);\n\n    detailDiv.querySelector('.tags').appendChild(Lab.ui.createList(items))\n\n}\n\nfunction createNew() {\n    let tags = Array.from(Array.from(detailDiv.querySelectorAll('input'), c => c).filter(c => c.checked), a => a.getAttribute('data-tag'));\n\n    let res = Array.from(Lab.base.cartesian(\n        Array.from(tags, t => goodDataSet[t])\n    ), d => d.join('\\n'));\n\n    res = Lab.base.shuffle(res);\n    // console.log(res.join('\\n-------------\\n'))\n    detailDiv.querySelector('.text').innerText = res[0];\n}\n\n// 匹配选择的tag\nfunction matchCardByTag(id = -1, tag = '') {\n    let matchs = tagsIndex.filter(t => t.tag === tag && t.id !== id);\n    matchs = matchs.sort((a, b) => b.weight - a.weight);\n    // console.log(id, matchs);\n    let idsIndex = {};\n\n    let newData = dataset.filter(d => d.id === id);\n    for (const m of matchs) {\n        newData = [...newData, ...dataset.filter(d => d.id === m.id)];\n    };\n\n    cardsDiv.innerHTML = '';\n    for (const d of newData) {\n        if (!idsIndex[d.id]) {\n            let g = createCard(d.id, d.text, d.tags);\n            cardsDiv.appendChild(g);\n            idsIndex[d.id] = true;\n        }\n    }\n}\n\n// new LeaderLine(\n//   document.getElementById('start'),\n//   document.getElementById('end')\n// );\n// \nasync function getKeywordHotIndexFromBaidu(word) {\n    return new Promise((resolve, reject) => {\n        let web = document.createElement('webview');\n        web.style.display = 'none';\n        Lab.ui.add(web);\n        web.src = 'https://www.baidu.com/s?rtt=1&bsst=1&cl=2&tn=news&ie=utf-8&word=' + encodeURI(word);\n        web.addEventListener('did-finish-load', async(e) => {\n            let obj = await web.executeJavaScript(`\n                var nums=document.body.querySelector('#header_top_bar .nums').innerText;\n                var titles=Array.from(document.querySelectorAll('h3'),h=>h.innerText);\n                var obj={nums,titles};\n                obj`);\n            console.log(obj)\n            let res = Lab.nlp.jieba.tag(obj.nums.replace(/\\,/ig, ''));\n            web.remove();\n\n            resolve(res);\n        })\n\n    })\n\n}",
  "code_length": 166,
  "size": [
    685,
    800
  ],
  "extname": "designlabplugin",
  "version": "0.1",
  "package_version": "0.1.2",
  "package_id": "9b7e4f0a363085fd979ab91289b7a4798ba35f0f",
  "dependencies": {
    "@ffmpeg-installer/ffmpeg": "^1.0.20",
    "@ffprobe-installer/ffprobe": "^1.1.0",
    "@fortawesome/fontawesome-free": "^5.15.3",
    "@hapi/hapi": "^20.1.2",
    "@node-rs/jieba": "^1.1.0",
    "@paddlejs-models/humanseg": "0.0.5",
    "@tensorflow-models/body-pix": "^2.1.0",
    "@tensorflow-models/deeplab": "^0.2.1",
    "@tensorflow-models/face-landmarks-detection": "0.0.1",
    "@tensorflow-models/knn-classifier": "^1.2.2",
    "@tensorflow-models/mobilenet": "^2.1.0",
    "@tensorflow-models/posenet": "^2.2.2",
    "@tensorflow/tfjs": "^3.3.0",
    "@tensorflow/tfjs-backend-wasm": "^3.3.0",
    "@tensorflow/tfjs-converter": "^2.8.6",
    "@tensorflow/tfjs-node": "^3.3.0",
    "about-window": "^1.14.0",
    "blockly": "^4.20201217.0",
    "color": "^3.1.3",
    "colorthief": "^2.3.2",
    "electron-json-storage": "^4.4.0",
    "escodegen": "^2.0.0",
    "espree": "^7.3.1",
    "estraverse": "^5.2.0",
    "exceljs": "^4.2.1",
    "fabric": "^4.3.1",
    "fluent-ffmpeg": "^2.1.2",
    "fomantic-ui": "^2.8.7",
    "gif.js": "^0.2.0",
    "gifuct-js": "^2.1.1",
    "idb-kv-store": "^4.5.0",
    "internal-ip": "^6.2.0",
    "jimp": "^0.16.1",
    "leader-line": "^1.0.5",
    "lowdb": "^1.0.0",
    "make-cert": "^1.2.0",
    "marked": "^1.2.9",
    "md5": "^2.3.0",
    "mime-types": "^2.1.30",
    "mkcert": "^1.4.0",
    "monaco-editor": "^0.21.3",
    "muuri": "^0.9.3",
    "ngraph.path": "^1.3.1",
    "nouislider": "^14.7.0",
    "object-hash": "^2.1.1",
    "opencvjs-dist": "^4.4.0",
    "p5": "^1.3.1",
    "p5.createloop": "^0.2.8",
    "pdfjs-dist": "^2.6.347",
    "peer": "^0.6.1",
    "peerjs": "^1.3.2",
    "recordrtc": "^5.6.2",
    "smartcrop": "^2.0.3",
    "socket.io": "^4.0.0",
    "socket.io-client": "^4.0.0",
    "spatial-db": "0.0.25",
    "sweetalert2": "^10.15.7",
    "timeago.js": "^4.0.2",
    "wordcloud": "^1.2.2",
    "yoga-layout-wasm": "^1.9.3-alpha.7"
  },
  "author": "shadow",
  "create_time": 1623679197189
}